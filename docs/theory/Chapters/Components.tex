\chapter{Component Effects on Fluid}

This chapter will describe the mathematical theory used to model the effect each component has
on a fluid.  The components of interest in this chapter are those that are
common in gas-flow thermodynamic systems such as jet engines and electrical power plants.
All models describe in this document assume adiabatic, isentropic conditions.
% ===========================================================================================================
% ===========================================================================================================

\section{Background}
A full survey of thermodynamics is beyond the scope of this document; however, the following
relationships form the basis for all the adiabatic-isentropic relationships described in this document.

All equations in the {\emph{Thermodynamic Systems}} code assume ideal gas conditions, 
which are achieved by assuming one dimensional flow.  An ideal gas can be approximated by
Equation \ref{eq:ideal_gas} where $\rho$ is density, $R$ is the gas constant and $T$ is the static
temperature.  The constant $R_o$ is the ideal gas constant of 8.314 J/(kg$\cdot$mole) and $M$
is the molar mass of the fluid in units of grams per mole.

\begin{equation}
\label{eq:ideal_gas}
p=\rho RT
\end{equation}

\noindent where

\begin{equation}
R=\frac{R_o}{M}
\end{equation}

\noindent In addition, ideal, non-compressible flow is assumed, which implies the rule of continuity in Equation \ref{eq:continuity}, 
where $\dot{m}$ represents the mass flow rate, $u$ represents the flow velocity, and $A$ represents
the cross-sectional area of the flow-channel.  The subscripts $1$ and $2$ imply the up-stream and down-stream conditions respectively.

\begin{equation}
\label{eq:continuity}
\dot{m}_1 = \dot{m}_2 = \rho_1u_1A_1 = \rho_2u_2A_2
\end{equation}

In an adiabatic system the stagnation conditions can be estimated from the fluid Mach number via equations \ref{eq:stag_pressure} 
and \ref{eq:stag_temperature} where $M$ represents the Mach number, $\gamma$ represents the ratio of specific heats ($c_p/c_v$), $P_o$ 
is stagnation pressure, $P$ is static pressure, $T$ is static temperature and $T_o$ represents the stagnation temperature.
The terms $c_p$ and $c_v$ represents the specific heats at constant pressure and volume respectively.  

\begin{equation}
\label{eq:stag_pressure}
\frac{P_o}{P}=\left(1 + \frac{\gamma - 1}{2}M^2\right)^{1/\left(\gamma-1\right)}
\end{equation}

\begin{equation}
\label{eq:stag_temperature}
\frac{T_o}{T}=1 + \frac{\gamma-1}{2}M^2
\end{equation}

\noindent where;

\begin{equation}
\label{eq:mach}
M = \frac{u}{\sqrt[]{\gamma R T}}
\end{equation}

\noindent Assuming that the ratio of specific heats ($\gamma$) is constant across a 
process where work is done, then we can assume a relationship between
the stagnation conditions at the entrance and exit to the work process.

\begin{equation}
\label{eq:stag}
\frac{P_{o1}}{P_{o2}}=\left(\frac{T_{o1}}{T_{o2}}\right)^{\gamma/\left(\gamma-1\right)}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\section{Diffuser/Nozzle}
A diffuser slows the fluid velocity by increasing the flow area and a nozzle executes the inverse.  According to Equation \ref{eq:continuity}, 
assuming the fluid density does not change, which is consistent with non-compressible flow, an increase in the 
area of a piping system will necessitate a decrease in the fluid velocity.   In theory, no work is executed in a nozzle
or a diffuser, which implies that the stagnation conditions should be equal at the entrance and the exit
to a diffuser or nozzle.  However, real systems will always incur some thermodynamic losses, which will
decrease the stagnation conditions across the nozzle or diffuser, which can be approximated through
isentropic efficiencies ($\eta$) .  The isentropic efficiency, inlet area and exit area can be considered as attributes of a diffuser.
The models described in this section were derived from 
\textit{Mechanics and Thermodynamics of Propulsion} by Hill and Peterson\cite{Hill} and a 
Masters Thesis by Webb\cite{Webb}.  All models calculate exit conditions with an assumption that the inlet conditions are known.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Stagnation Pressure and Temperature}
The stagnation pressure at the diffuser exit can be determined via Eq. \ref{eq:dif_stag_pressure} 
where $\eta_d$ is the isentropic efficiency of the diffuser.  The value of $\eta_d$ can be replaced
with $\eta_n$ for a nozzle.

\begin{equation}
\label{eq:dif_stag_pressure}
P_{o2}=P_{o1}\left(\eta_d\left[\frac{\gamma-1}{2}\right]M^2+1\right)^{\gamma/\left(\gamma-1\right)}
\end{equation}

\noindent The stagnation temperature is determined via Eq. \ref{eq:stag}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Static Pressure and Temperature}
The static temperature (T) is calculated via Eq. \ref{eq:diff_stat_temp} where the derivation of the velocity is described
in Section \ref{dif:mach}.

\begin{equation}
\label{eq:diff_stat_temp}
T = T_o-\frac{u^2}{2c_p}
\end{equation}

\noindent The static pressure is determine via Eq. \ref{eq:stag_pressure} where the stagnation pressure ($P_o$) is
determined via Eq. \ref{eq:dif_stag_pressure} and the Mach number ($M$) is determined through the method 
described in Section \ref{dif:mach}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Velocity and Mach Number} \label{dif:mach}
The fluid velocity ($u$) leaving the diffuser or nozzle is determined via Eq. \ref{eq:continuity} and the Mach number ($M$) is calculated
using Eq. \ref{eq:mach}.  The static temperature ($T$) used in Eq. \ref{eq:mach} is calculated from \ref{eq:diff_stat_temp}.  The calculation of velocity
and Mach number assume that the flow is subsonic and non-compressible.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Density}
The fluid density is determined with a-priori knowledge of the mass flow rate ($\dot{m}$) and Eq. \ref{eq:continuity}.  The fluid velocity $u$ 
required in Eq. \ref{eq:continuity} is determined in Section \ref{dif:mach}.
% ===========================================================================================================
% ===========================================================================================================

\section{Compressor}
A compressor does work upon a system and increases the stagnation conditions (i.e. $T_o$, $P_o$), and thereby the fluid density.  There
are isentropic losses in a compressor, which are approximated by the term $\eta_c$. The isentropic efficiency and compression 
ratio (i.e $P_{cr}=P_{o2}/P_{o1}$) are considered as compressor attributes. The models described in this section were derived 
from \textit{Mechanics and Thermodynamics of Propulsion} by Hill and Peterson\cite{Hill} and a Masters Thesis by Webb\cite{Webb}.
All models calculate exit conditions with an assumption that the inlet conditions are known.

\subsection{Fluid Stagnation Pressure and Temperature}
The stagnation pressure is determined with knowledge of the inlet stagnation pressure and the compression ratio ($P_{cr}$) and is
shown in Eq. \ref{eq:comp_stag_pressure}.

\begin{equation}
\label{eq:comp_stag_pressure}
P_{o2} = P_{o1}P_{cr}
\end{equation}

The stagnation temperature at the compressor exit can also be expressed in terms of the inlet stagnation temperature and the 
compression ration as shown in Eq. \ref{eq:comp_stag_temp}

\begin{equation}
\label{eq:comp_stag_temp}
T_{o2}=T_{o1}\left[1 + \frac{1}{\eta_c}\left(p_{cr}^{\frac{\gamma-1}{\gamma}}\right)-1\right]
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Static Pressure and Temperature}
The fluid static pressure and temperature are determined via Equations \ref{eq:stag_pressure} and \ref{eq:stag_temperature} with knowledge of the 
inlet stagnation conditions to determine he exit stagnation conditions using Equations \ref{eq:comp_stag_pressure} and \ref{eq:comp_stag_temp} 
and the Mach number which is determined from Eq. \ref{eq:com_mach_number}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Velocity and Mach Number}
The compressor exit Mach number cannot be directly calculated and instead must be iteratively solved for as a root for 
Equation \ref{eq:com_mach_number} with knowledge of the inlet stagnation temperature, outlet stagnation temperature, and inlet mach number.

\begin{equation}
\label{eq:com_mach_number}
\frac{T_{o2}}{T_{o1}} = \left[\frac{1 + \gamma M^2_2}{1 + \gamma M^2_1} \right]^2 \left(\frac{1 + \frac{\gamma-1}{2}M^2_2}{1 + \frac{\gamma - 1}{2}M^2_1} \right)
\end{equation}

\noindent The fluid velocity is then determined in accordance with Equation \ref{eq:comp_fluid_velocity}

\begin{equation}
\label{eq:comp_fluid_velocity}
u=M \sqrt[]{\gamma R T}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Density}
The fluid density leaving the compressor is determined via Equation \ref{eq:comp_density}

\begin{equation}
\label{eq:comp_density}
\rho = \frac{\dot{m}}{uA}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Compressor Work}
The compressor does work on the system in order to change the stagnation conditions.  The work done by the compressor on the fluid
is modeled via Eq. \ref{eq:comp_work}.

\begin{equation}
\label{eq:comp_work}
W_c = \dot{m}c_p\left(T_{o2} - T_{o1}\right)
\end{equation}
% ===========================================================================================================
% ===========================================================================================================

\section{HeatAddition}
Typical thermodynamic systems have a combustion chamber or a heat exchanger where energy is added to the system.  As with all other
thermodynamic systems a heat addition unit is accompanied by an isentropic efficiency ($\eta_{he}$) where the subscript he refers to 
a heat exchanger.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Power Addition}
The required power that must be supplied to the heat exchanger or combustion chamber is determined with knowledge of the heat to 
be added to the fluid $\dot{Q}_{he}$ via Eq. \ref{eq:supplied_heat}

\begin{equation}
\label{eq:supplied_heat}
\dot{Q}_{t} = \frac{\dot{Q}_{he}}{\eta_{he}}
\end{equation}

For a thermodynamic propulsion systems the heat addition $\dot{Q}_{he}$ is driven by the energy required to drive a nozzle
exit velocity $\dot{Q}_{KE}$ and also possibly the work that must be extracted by the compressor $\dot{W}_c$.  The compressor 
work is described in equation \ref{eq:comp_work}, the energy addition to drive a nozzle exit velocity is described in Eq. \ref{eq:ke}
where $V_e$ represents the nozzle exit velocity and $V_\infty$ represents the free field fluid velocity outside of the engine.

\begin{equation}
\label{eq:ke}
\dot{Q}_{KE} = \frac{\dot{m}}{2}\left(V^2_e-V^2_{\infty}\right)
\end{equation}

\begin{equation}
\label{eq:total_heat}
\dot{Q}_t = \dot{Q}_{KE} + \dot{W_c}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Stagnation Pressure and Temperature}

The stagnation temperature at the heat addition exit $T_{o2}$ can be determined with knowledge of the heat addition $\dot{Q}_{he}$ and the
specific heat of the fluid $c_p$ as well as the mass flow rate $\dot{m}$ as shown in Eq. \ref{eq:he_stag_temp}

\begin{equation}
\label{eq:he_stag_temp}
T_{o2} = T_{o1} + \frac{\dot{Q}_{he}}{\dot{m}c_p}
\end{equation}

The stagnation temperature is determined by solving Equation \ref{eq:he_stag_pressure} with knowledge of the inlet conditions 
($M_1$ and $P_{o1}$) and the exit Mach Number ($M_2$).

\begin{equation}
\label{eq:he_stag_pressure}
P_{o2} = P_{o1}\left(\frac{1 + \gamma M^2_1}{1 + \gamma M^2_2} \right) \left(\frac{1 + \frac{\gamma - 1}{2}M^2_2}{1 + \frac{\gamma -1}{2}M^2_1} \right)^{\frac{\gamma}{\gamma - 1}}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Static Pressure and Temperature}
The static temperature and pressure can be determined with Equations \ref{eq:stag_temperature} and \ref{eq:stag_pressure}.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Velocity and Mach Number}
The fluid Mach number leaving the heat addition component is determine with knowledge of the inlet conditions ($T_{o1}$ and $M_1$) as
well as the exit Stagnation temperature ($T_{o2}$) and Equation \ref{eq:com_mach_number}.  The equation is implicit and cannot be solved
directly, so a root finder must be employed to solve this equation.  The ThermSystems code uses the bisect method to determine the roots
for $M_2$.  The fluid velocity is determined by multiplying the Mach number by the speed of sound as determined in Eq. \ref{eq:mach}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Density}
The fluid density leaving the heat addition component is determined via Eq. \ref{eq:comp_work}
% ===========================================================================================================
% ===========================================================================================================

\section{Turbine}
A turbine extracts energy from a fluid field, either to run an alternator that produces electricity or to supply mechanical energy to
a compressor.  As with all other thermodynamic systems a turbine is accompanied by an isentropic efficiency ($\eta_{t}$) 
where the subscript he refers to a heat exchanger.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Work Extraction}
A turbine must extract a certain amount ($\dot{W}_t$) of work from the flow field to supply the mechanical energy needs of an alternator
or a compressor.  In order to ensure that the amount of work extracted is correct, we must divide the compressor work $\dot{W}_t$ by 
the turbine isentropic efficiency to understand the total work to be extracted as shown in Eq. \ref{eq:work_extraction}.  If the work 
is to be supplied to a compressor then $\dot{W}_t$ is equal to $\dot{W}_c$

\begin{equation}
\label{eq:work_extraction}
\dot{W}_{total} = \frac{\dot{W}_t}{\eta_t}
\end{equation}

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Stagnation Temperature and Pressure}
The stagnation temperature at the turbine exit can be determine via Eq. \ref{eq:turb_stag_temp}

\begin{equation}
\label{eq:turb_stag_temp}
T_{o2} = T_{o1} - \frac{\dot{W}_{total}}{\dot{m}c_p}
\end{equation}

The stagnation temperature at the turbine exit can be detemrined via Eq. \ref{eq:turb_stag_pres}

\begin{equation}
\label{eq:turb_stag_pres}
P_{o2} = P_{o1}\left[1 - \frac{1}{\eta_t}\left(1 - \frac{T_{o2}}{T_{o1}} \right) \right]^{\frac{\gamma}{\gamma - 1}}
\end{equation}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid StaticTemperature and Pressure}
The fluid static temperature and pressure are determined from Equations  \ref{eq:stag_temperature} and \ref{eq:stag_pressure}.
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Velocity and Mach Number}
The fluid Mach number is determined from Equation \ref{eq:com_mach_number}
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\subsection{Fluid Density}
The fluid density leaving the turbine is determined via Eq. \ref{eq:comp_work}
% ===========================================================================================================
% ===========================================================================================================

\begin{thebibliography}{2}

\bibitem{Hill} Hill, P. and Peterson, C., \emph{Machanics and Thermodynamics of Propulsion}, Addison-Wesley, Reading, MA, 1992.

\bibitem{Webb} Webb, J., A., \emph{Radioisotope Heated Air-breathing Engine Design for Flight Applications on Titan}, A M.S. Thesis at
                         the Idaho State University, Dept. of Nuclear Engineering, 2009.
\end{thebibliography}